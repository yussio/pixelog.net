<%
let arr = new Array();
site.posts.each(function(post){
  arr.push(post.date.format('YYYY年MM月'))
})

arr = toCountDict(arr.sort().reverse());

function toCountDict(array){
  let dict = {};
  for(let key of array){
    dict[key] = array.filter(function(x){return x==key}).length;
  }
  return dict;
}
%>

<div class="<%= block %>__search">
  <h4 class="<%= block %>__title">Archive</h4>
  <select class="archive-list" name="sort" onchange="location.href=this.value;">
      <option value="">月を選択</option>
      <% Object.keys(arr).forEach(function(key){ %>
        <option value="/<%= config.archive_dir %>/<%= key.slice(0,4) %>/<%= key.slice(5,7) %>/"><%= key %> (<%= arr[key]%>)</option>
      <% }); %>
  </select>
</div>
