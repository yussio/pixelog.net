<aside class="aside">
    <div class="widget__ad loading">
        <!-- サイドバー -->
        <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-9027963984337121"
           data-ad-slot="7285089388"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
        <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    <div class="widget__category">
        <h4 class="widget__title">Category</h4>
        <%
        // https://github.com/hexojs/hexo/issues/3588
        function displayCategories(parent = undefined) {
          site.categories
            .find({ parent }) // warehouse allows us complex queries
            .sort("name") // sort
            .each(function(category) {
              // count the child categories
              const childCount = site.categories.find({ parent: category._id }).count();
              %>
              <li class="category-list-item">
                <a class="category-list-link

                <%
                var current_category;
                if(is_category()) {
                    current_category = page.category;
                } else if(is_post()) {
                    current_category = page.categories.data[page.categories.length - 1].name;
                } else {
                    current_category = '';
                }
                if(current_category === category.name) { %>
                    current
                <% } %>

                " href="<%=url_for(category.path)%>"><%=category.name%></a>
                <span class="category-list-count"><%= category.length%></span>

                <% if (childCount > 0) { %>
                  <ul class="category-list-child">
                    <% displayCategories(category._id); %>
                  </ul>
                <% } %>
              </li>
              <%
            });
        }
        %>
        <ul class="category-list">
          <% displayCategories(); %>
        </ul>
    </div>

    <% if (is_post() === true) { %>
    <div class="widget__recent-posts">
        <h4 class="widget__title">Recent Posts</h4>
        <%- list_posts( {
          class: 'recent-posts'
        }) %>
    <% } %>
    </div>
</aside>
